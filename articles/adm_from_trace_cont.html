<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="admtools">
<title>Estimating Age-Depth Models from Tracer Contents of Rocks and Sediments • admtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating Age-Depth Models from Tracer Contents of Rocks and Sediments">
<meta property="og:description" content="admtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">admtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/admtools.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/adm_from_sedrate.html">Estimating Age-Depth Models from Sedimentation Rates</a>
    <a class="dropdown-item" href="../articles/adm_from_trace_cont.html">Estimating Age-Depth Models from Tracer Contents of Rocks and Sediments</a>
    <a class="dropdown-item" href="../articles/adm_plotting.html">adm_plotting</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MindTheGap-ERC/admtools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Estimating Age-Depth Models from Tracer Contents of Rocks and Sediments</h1>
                        <h4 data-toc-skip class="author">Niklas
Hohmann</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MindTheGap-ERC/admtools/blob/HEAD/vignettes/adm_from_trace_cont.Rmd" class="external-link"><code>vignettes/adm_from_trace_cont.Rmd</code></a></small>
      <div class="d-none name"><code>adm_from_trace_cont.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette gives an example on how to estimate age-depth models
(ADMs) from tracer contents of rocks and sediments using the function
<code>strat_cont_to_multiadm</code>. The function takes the following
inputs:</p>
<ul>
<li><p><code>h_tp</code> : a function that returns stratigraphic height
of the tie points</p></li>
<li><p><code>t_tp</code> : a function that returns times of the tie
points</p></li>
<li><p><code>strat_cont_gen</code> : a function that returns tracer
contents observed in the section, outcrop, or drillcore</p></li>
<li><p><code>time_cont_gen</code> : a function that returns how tracer
input into the sediment changed with time</p></li>
<li><p><code>h</code> : vector of heights where the ADMs are
estimated</p></li>
<li><p><code>no_of_rep</code> : integer, number of age-depth models
determined</p></li>
</ul>
<div class="section level3">
<h3 id="idea">Idea<a class="anchor" aria-label="anchor" href="#idea"></a>
</h3>
<p>Assume there is a tracer embedded in rocks or sediment (e.g. Pollen,
extraterrestrial 3He, etc.). In addition, there some information on the
temporal variations of the tracer available. Then the tracer values
measure in the sediment can be compared to the assumed input flux of the
tracer to construct rates of sediment accumulation, from which an
age-depth model can be constructed.</p>
<p>A standard example is when tracer input into the sediment is
constant. The high tracer values reflect low rates of sediment
accumulation, which is equivalent to a low gradient of the age-depth
model.</p>
<p>This idea is formalized using the idea of stratigraphic content and
time content: Stratigraphic content is the tracer value measured in the
section (units tracer per length unit), and time content is the input of
tracer into the sediment (units tracer per time unit).</p>
</div>
<div class="section level3">
<h3 id="coding-tie-points">Coding tie points<a class="anchor" aria-label="anchor" href="#coding-tie-points"></a>
</h3>
<p>Times and heights of tie points are coded via the functions
<code>t_tp</code> (timing) and <code>h_tp</code> (height) that take no
inputs. They serve as wrappers around user-defined procedures that
reflect uncertainties around tie points. Every time <code>t_tp</code>
and <code>h_tp</code> are evaluated, they return possible values for the
tie points. Writing these functions requires some effort, but it allows
the user to hand over arbitrarily complex uncertainties of the tie
points to the <code>strat_cont_to_multiadm</code> function.</p>
<p>The function for the heights of the tie points must return an ordered
vector of tie point heights.</p>
<p>For this example, I assume the stratigraphic positions of the tie
points are known without uncertainty, and are at 10 and 20 m
stratigraphic height.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h_min</span> <span class="op">=</span> <span class="fl">10</span> <span class="co"># stratigraphic height of lower tie point [m]</span></span>
<span><span class="va">h_max</span> <span class="op">=</span> <span class="fl">20</span> <span class="co"># stratigraphic height of upper tie point [m]</span></span></code></pre></div>
<p><code>h_tp</code> is then implemented as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h_tp</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h_min</span>, <span class="va">h_max</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>When evaluated, this function returns the stratigraphic positions of
the tie points:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">h_tp</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10 20</span></span></code></pre></div>
<p>The function for the timing of the tie points must return a vector of
strictly increasing values corresponding to the times of the tie
points.</p>
<p>For this example, I assume that the timing of the first tie point
follows a normal distribution with mean 0 and standard deviation 0.5.
For the second tie point, only maximum and minimum time is available.
Due to the lack of information, I assume a uniform distribution between
the minimum (9) and the maximum (11). This is implemented as follows in
<code>t_tp</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_tp</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># timing first tie point</span></span>
<span>  <span class="va">t1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># timing second tie point</span></span>
<span>  <span class="va">t2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, min <span class="op">=</span> <span class="fl">9</span>, max <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">t1</span>, <span class="va">t2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Using Myr as time unit, the distribution of times for the tie points
is as follows:</p>
<p><img src="adm_from_trace_cont_files/figure-html/unnamed-chunk-4-1.png" width="700"><img src="adm_from_trace_cont_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="coding-stratigraphic-data">Coding stratigraphic data<a class="anchor" aria-label="anchor" href="#coding-stratigraphic-data"></a>
</h3>
<p>Both stratigraphic contents and age contents must be coded as
function factories, i.e., functions that return functions. They must be
able to take vector inputs and return a vector of the same length as
output.</p>
<p>I assume the tracer input into the sediment is constant with time.
This is implemented with the following function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_cont_gen</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">time_cont</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approxfun</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, rule <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">time_cont</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To visualize this, let’s plot this from time 0 to 10:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate one function from time_cont_gen</span></span>
<span><span class="va">time_cont</span> <span class="op">=</span> <span class="fu">time_cont_gen</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># time where to evaluate the function</span></span>
<span><span class="va">t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span>,by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>,</span>
<span>     y <span class="op">=</span> <span class="fu">time_cont</span><span class="op">(</span><span class="va">t</span><span class="op">)</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Tracer Input into the Sediment [1/Myr]"</span><span class="op">)</span></span></code></pre></div>
<p><img src="adm_from_trace_cont_files/figure-html/unnamed-chunk-6-1.png" width="700">
The implementation of the tracer values can be simplified using the
helper functions <code>flux_const</code>, <code>flux_linear</code>,
<code>flux_quad</code> that are wrappers that define constant, linear,
and quadratic changes of tracer flux with time.</p>
<p>For the tracer measured in the section, I assume it was measured at
the bottom, middle, and top of the examined section:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">locations</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"h_1"</span> <span class="op">=</span> <span class="va">h_min</span>, <span class="st">"h_2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h_min</span>, <span class="va">h_max</span><span class="op">)</span><span class="op">)</span>, <span class="st">"h_3"</span> <span class="op">=</span> <span class="va">h_max</span><span class="op">)</span></span></code></pre></div>
<p>At these locations, tracer values each follow a normal distribution
with mean 10, 1, and 8 and standard deviations 1, 0.1, and 0.2.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_vals</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu_1"</span> <span class="op">=</span> <span class="fl">10</span>, <span class="st">"mu_2"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"mu_3"</span> <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">sd_vals</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sig_1"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"sig_2"</span> <span class="op">=</span> <span class="fl">0.1</span>, <span class="st">"sig_3"</span> <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p>I assume that between the measured points, tracer values change
linearly. With these assumptions and values, the function factory for
the tracer can be coded as follows</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat_cont_gen</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="va">loc</span> <span class="op">=</span> <span class="va">locations</span></span>
<span>   <span class="va">trac_vals</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mean_vals</span><span class="op">)</span>,</span>
<span>                     mean <span class="op">=</span> <span class="va">mean_vals</span>,</span>
<span>                     sd <span class="op">=</span> <span class="va">sd_vals</span><span class="op">)</span></span>
<span>   <span class="va">strat_cont</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approxfun</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">loc</span>,</span>
<span>                          y <span class="op">=</span> <span class="va">trac_vals</span>,</span>
<span>                          yleft <span class="op">=</span> <span class="va">trac_vals</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                          yright <span class="op">=</span> <span class="va">trac_vals</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span>   <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">strat_cont</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To visualize this, here are 3 possible scenarios of how tracer values
change in the section:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">3</span> <span class="co"># number of sampled tracer values </span></span>
<span><span class="va">h</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">h_min</span>, <span class="va">h_max</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="co"># determine age-depth model every 0.1 m</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NULL</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h_min</span>, <span class="va">h_max</span><span class="op">)</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mean_vals</span><span class="op">)</span> <span class="op">+</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sd_vals</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Stratigraphic Height [m]"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Measured Tracer [1/m]"</span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">strat_cont</span> <span class="op">=</span> <span class="fu">strat_cont_gen</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">h</span>,</span>
<span>        y <span class="op">=</span> <span class="fu">strat_cont</span><span class="op">(</span><span class="va">h</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="adm_from_trace_cont_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="estimating-the-age-depth-model">Estimating the age-depth model<a class="anchor" aria-label="anchor" href="#estimating-the-age-depth-model"></a>
</h2>
<p>With all the input data coded, age-depth models can be estimated
using the function <code>strat_cont_to_multiadm</code>. Here, I
determine the age-depth models every 0.25 m, and generate 10 ADMs</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">h_min</span>,<span class="va">h_max</span>, by <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="co"># strat. positions where ADMs are estimated</span></span>
<span><span class="va">no_of_rep</span> <span class="op">=</span> <span class="fl">1000</span> <span class="co"># no. of ADMs estimated</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_adm</span> <span class="op">=</span> <span class="fu"><a href="../reference/strat_cont_to_multiadm.html">strat_cont_to_multiadm</a></span><span class="op">(</span>h_tp <span class="op">=</span> <span class="va">h_tp</span>,</span>
<span>                                t_tp <span class="op">=</span> <span class="va">t_tp</span>,</span>
<span>                                strat_cont_gen <span class="op">=</span> <span class="va">strat_cont_gen</span>,</span>
<span>                                time_cont_gen <span class="op">=</span> <span class="va">time_cont_gen</span>,</span>
<span>                                h <span class="op">=</span> <span class="va">h</span>,</span>
<span>                                no_of_rep <span class="op">=</span> <span class="va">no_of_rep</span>,</span>
<span>                                T_unit <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                                L_unit <span class="op">=</span> <span class="st">"Myr"</span><span class="op">)</span></span></code></pre></div>
<p>The estimated age-depth model can be handed to plot to display
it:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_adm</span>, mode <span class="op">=</span> <span class="st">"envelope"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/T_axis_lab.html">T_axis_lab</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># plot time axis label, see ?T_axis_lab for details</span></span>
<span><span class="fu"><a href="../reference/L_axis_lab.html">L_axis_lab</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># plot length axis label, see ?L_axis_lab for details</span></span>
<span><span class="fu"><a href="../reference/make_legend.html">make_legend</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># make legend</span></span></code></pre></div>
<p><img src="adm_from_trace_cont_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="further-information">Further information<a class="anchor" aria-label="anchor" href="#further-information"></a>
</h2>
<p>For information on estimating age-depth models from sedimentation
rates, see</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"adm_from_sedrate"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<p>For a simplified application see</p>
<ul>
<li>Jarochowska, E., Nohl, T., Grohganz, M., Hohmann, N., Vandenbroucke,
T. R. A., &amp; Munnecke, A. (2020). Reconstructing depositional rates
and their effect on paleoenvironmental proxies: The case of the Lau
Carbon Isotope Excursion in Gotland, Sweden. Paleoceanography and
Paleoclimatology, 35, e2020PA003979. <a href="https://doi.org/10.1029/2020PA003979" class="external-link">DOI:
10.1029/2020PA003979</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Niklas Hohmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
