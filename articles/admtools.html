<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>admtools: Getting Started • admtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="admtools: Getting Started">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">admtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/admtools.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/adm_from_sedrate.html">Estimating Age-Depth Models from Sedimentation Rates</a></li>
    <li><a class="dropdown-item" href="../articles/adm_from_trace_cont.html">Estimating Age-Depth Models from Tracer Contents of Rocks and Sediments</a></li>
    <li><a class="dropdown-item" href="../articles/adm_plotting.html">Plotting Age-Depth Models</a></li>
    <li><a class="dropdown-item" href="../articles/admtools_doc.html">Structure and classes of the admtools package</a></li>
    <li><a class="dropdown-item" href="../articles/correlation.html">Depth-depth curves and correlation</a></li>
    <li><a class="dropdown-item" href="../articles/FossilSim_integration.html">Integration with the FossilSim and paleotree packages</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MindTheGap-ERC/admtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>admtools: Getting Started</h1>
                        <h4 data-toc-skip class="author">Niklas
Hohmann</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MindTheGap-ERC/admtools/blob/main/vignettes/admtools.Rmd" class="external-link"><code>vignettes/admtools.Rmd</code></a></small>
      <div class="d-none name"><code>admtools.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette is an introduction to the <em>admtools</em>
package.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<div class="section level4">
<h4 id="from-github">From GitHub<a class="anchor" aria-label="anchor" href="#from-github"></a>
</h4>
</div>
<div class="section level4">
<h4 id="from-cran">From CRAN<a class="anchor" aria-label="anchor" href="#from-cran"></a>
</h4>
<p>To install the package from <em>CRAN</em>, run</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"admtools"</span><span class="op">)</span></span></code></pre></div>
<p>To install the package from <em>GitHub</em>, first install the
<em>remotes</em> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span></code></pre></div>
<p>Then run</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"MindTheGap-ERC/admtools"</span>,</span>
<span>                        build_vignettes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                        ref <span class="op">=</span> <span class="st">"HEAD"</span>,</span>
<span>                        dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>to install the latest stable version.</p>
</div>
</div>
<div class="section level3">
<h3 id="loading-the-package">Loading the package<a class="anchor" aria-label="anchor" href="#loading-the-package"></a>
</h3>
<p>Load the package using</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MindTheGap-ERC/admtools" class="external-link">admtools</a></span><span class="op">)</span></span></code></pre></div>
<p>This makes all functions in the package available.</p>
</div>
<div class="section level3">
<h3 id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h3>
<p>Use</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"admtools"</span><span class="op">)</span></span></code></pre></div>
<p>to get an overview of the available help pages of the package,
and</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">admtools</span></span></code></pre></div>
<p>to view a simple help page for the package.</p>
<p>Vignettes are a long form of package documentation that provide more
detailed examples. To list the available vignettes, use</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"admtools"</span><span class="op">)</span> <span class="co"># opens in Browser</span></span>
<span><span class="co">#or</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"admtools"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-adm-and-multiadm-classes">The adm and multiadm classes<a class="anchor" aria-label="anchor" href="#the-adm-and-multiadm-classes"></a>
</h3>
<p>The <em>admtools</em> package defines three main classes:
<code>adm,</code> <code>sac</code> and <code>multiadm</code>. The class
<code>adm</code> represent a single age-depth model, from which
information can be extracted (e.g. completeness, number of hiatuses,
etc.) and that can be used to transform data between the stratigraphic
domain and time domain. The <code>multiamd</code> class is a list of
<code>adm</code> objects. <code>multiadm</code> objects are used to
represent uncertainties of age-depth models. Objects of type
<code>sac</code> are sediment accumulation curves that can contain
information on erosion, and can be turned into age-depth models.</p>
</div>
<div class="section level3">
<h3 id="conventions">Conventions<a class="anchor" aria-label="anchor" href="#conventions"></a>
</h3>
<p>In contrast to its name, the <em>admtools</em> package currently
deals with time and height instead of age and depth. In this sense, the
age-depth models are time-height models. Both time and height can be
negative values. To handle ages, use time before the present. To handle
depths, use height below a point of reference (e.g., the sediment
surface).</p>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>This example explains the construction and application of
<code>adm</code> objects. As example data we use outputs from CarboCAT
Lite, a model of carbonate platform growth <a href="#References">(Burgess 2013, 2023)</a>. This data is automatically
loaded in the background by the package. To get some info of the data
use</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">CarboCATLite_data</span></span></code></pre></div>
<p>This data is identical to scenario A from <a href="#References">Hohmann et al. (2024)</a> as published in <a href="#References">Hohmann et al. (2023)</a>. See therein for details on
the simulation, reproducibility, and a chronostratigraphic chart and a
figure showing a transect through the carbonate platform.</p>
<div class="section level4">
<h4 id="defining-age-depth-models">Defining age-depth models<a class="anchor" aria-label="anchor" href="#defining-age-depth-models"></a>
</h4>
<p>The standard constructor for age-depth models is
<code>tp_to_adm</code> (“tie point to age-depth model”). It returns an
objecto of class <code>adm</code>. This object combines information of
stratigraphic heights and times and erosive interval. It allows to
transform data between the stratigraphic and the time domain, and
identify which data is destroyed due to hiatuses.</p>
<p>As example, I use the timing and stratigraphic positions of tie
points taken from CarboCAT Lite to construct an age-depth model, and use
the option to directly associate length and time units with it.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># see ?tp_to_adm for detailed documentation</span></span>
<span><span class="va">my_adm</span> <span class="op">=</span> <span class="fu"><a href="../reference/tp_to_adm.html">tp_to_adm</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">CarboCATLite_data</span><span class="op">$</span><span class="va">time_myr</span>,</span>
<span>                  h <span class="op">=</span> <span class="va">CarboCATLite_data</span><span class="op">$</span><span class="va">height_2_km_offshore_m</span>,</span>
<span>                  L_unit <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                  T_unit <span class="op">=</span> <span class="st">"Myr"</span><span class="op">)</span></span></code></pre></div>
<p>This age-depth model represents the relationship between elapsed
model time and accumulated sediment 2 km offshore in a synthetic
carbonate platform.</p>
</div>
</div>
<div class="section level3">
<h3 id="representation">Representation<a class="anchor" aria-label="anchor" href="#representation"></a>
</h3>
<p>Typing the name <code>my_adm</code> in the console will only tell
that the generated variable is an age-depth model</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_adm</span></span>
<span><span class="co">#&gt; age-depth model</span></span></code></pre></div>
<p>To get a quick overview of the properties of <code>my_adm</code>, use
<code>summary</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">my_adm</span><span class="op">)</span></span>
<span><span class="co">#&gt; age-depth model </span></span>
<span><span class="co">#&gt; Total duration: 2 Myr</span></span>
<span><span class="co">#&gt; Total thickness: 146.0621 m</span></span>
<span><span class="co">#&gt; Stratigraphic completeness: 32.65 % </span></span>
<span><span class="co">#&gt; 10 hiatus(es)</span></span></code></pre></div>
<p>If you want to inspect the insides of the object, use
<code>str</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">my_adm</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ t     : num [1:2001] 0 0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 ...</span></span>
<span><span class="co">#&gt;  $ h     : num [1:2001] 0 0 0.609 1.095 1.722 ...</span></span>
<span><span class="co">#&gt;  $ destr : logi [1:2000] TRUE FALSE FALSE FALSE FALSE FALSE ...</span></span>
<span><span class="co">#&gt;  $ T_unit: chr "Myr"</span></span>
<span><span class="co">#&gt;  $ L_unit: chr "m"</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "adm"</span></span></code></pre></div>
<p>You can manually manipulate the fields of the <code>adm</code> object
by treating it like a list. I do not recommend doing so, as it might
result in unexpected downstream behavior. If you want to extract tie
points use <code>get_L_tp</code> and <code>get_T_tp</code>.</p>
<p>You can plot <code>adm</code> objects via the standard
<code>plot</code> function. Here, I use the option to highlight hiatuses
in red, and increase the linw width of the conservative ( =
non-destructive) intervals.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># see ?plot.adm for plotting options for adm objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_adm</span>,</span>
<span>     col_destr <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>     lwd_acc <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/T_axis_lab.html">T_axis_lab</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># plot time axis label, see ?T_axis_lab for details</span></span>
<span><span class="fu"><a href="../reference/L_axis_lab.html">L_axis_lab</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># plot height axis label, see ?L_axis_lab for details</span></span></code></pre></div>
<p><img src="admtools_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>You can also plot sedimentation rates in the time domain using
<code>plot_sed_rate_t</code>“:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_sed_rate_t.html">plot_sed_rate_t</a></span><span class="op">(</span><span class="va">my_adm</span><span class="op">)</span></span></code></pre></div>
<p><img src="admtools_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>For more information on the extraction of sedimentation rates in the
time domain see the functions <code>sed_rate_t</code> and
<code>sed_rate_t_fun</code>. Sedimentation rates in the length domain
can be extracted using <code>sed_rate_l</code> and
<code>sed_rate_l_fun</code> and plotted via
<code>plot_sed_rate_l</code>. In addition, condensation (time preserved
per stratigraphic increment) can be examined using the functions
<code>condensation</code>, <code>condensation_fun</code> and
<code>plot_condensation</code>.</p>
</div>
<div class="section level3">
<h3 id="extracting-data-from-age-depth-models">Extracting data from age-depth models<a class="anchor" aria-label="anchor" href="#extracting-data-from-age-depth-models"></a>
</h3>
<p>Use the functions <code>get_total_duration</code>,
<code>get_total_thickness</code>, <code>get_completeness</code>, and
<code>get_hiat_no</code> to extract information:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_total_duration.html">get_total_duration</a></span><span class="op">(</span><span class="va">my_adm</span><span class="op">)</span> <span class="co">#total time covered by the age-depth model</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="fu"><a href="../reference/get_total_thickness.html">get_total_thickness</a></span><span class="op">(</span><span class="va">my_adm</span><span class="op">)</span> <span class="co"># total thickness of section represented by the adm</span></span>
<span><span class="co">#&gt; [1] 146.0621</span></span>
<span><span class="fu"><a href="../reference/get_completeness.html">get_completeness</a></span><span class="op">(</span><span class="va">my_adm</span><span class="op">)</span> <span class="co"># stratigraphic completeness as proportion</span></span>
<span><span class="co">#&gt; [1] 0.3265</span></span>
<span><span class="fu"><a href="../reference/get_completeness.html">get_incompleteness</a></span><span class="op">(</span><span class="va">my_adm</span><span class="op">)</span> <span class="co"># stratigraphic incompleteness (= 1- strat. incompleteness)</span></span>
<span><span class="co">#&gt; [1] 0.6735</span></span>
<span><span class="fu"><a href="../reference/get_hiat_no.html">get_hiat_no</a></span><span class="op">(</span><span class="va">my_adm</span><span class="op">)</span> <span class="co"># number of hiatuses</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<p>For more detailed information, you can use</p>
<ul>
<li>
<code>get_hiat_duration</code> to get a vector of hiatus
durations</li>
<li>
<code>get_hiat_list</code> to get a list of hiatus positions and
duration.</li>
</ul>
<p>For example, to plot a histogram of hiatus durations, use</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/get_hiat_duration.html">get_hiat_duration</a></span><span class="op">(</span><span class="va">my_adm</span><span class="op">)</span>,</span>
<span>     freq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Hiatus duration [Myr]"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Hiatus duration 2 km offshore"</span><span class="op">)</span></span></code></pre></div>
<p><img src="admtools_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>The function <code>is_destructive</code> can be used to examine
whether points in time coincide with hiatuses:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is_destructive.html">is_destructive</a></span><span class="op">(</span><span class="va">my_adm</span>,</span>
<span>               t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1] FALSE  TRUE</span></span></code></pre></div>
<div class="section level4">
<h4 id="transforming-data-between-time-and-stratigraphic-domain">Transforming data between time and stratigraphic domain<a class="anchor" aria-label="anchor" href="#transforming-data-between-time-and-stratigraphic-domain"></a>
</h4>
<div class="section level5">
<h5 id="heights-and-times">Heights and times<a class="anchor" aria-label="anchor" href="#heights-and-times"></a>
</h5>
<p>The functions <code>get_height</code> and <code>get_time</code> are
the workhorses to transform data using age-depth models.</p>
<ul>
<li>
<code>get_time</code> takes and <code>adm</code> object and vector
of heights <code>h</code> (stratigraphic positions), and returns a
vector of times</li>
<li>
<code>get_height</code> takes an <code>adm</code> object and vector
of times <code>t</code> and returns a vector of associated stratigraphic
positions</li>
</ul>
<p>As example, say we want to know the time of deposition of the
following stratigraphic positions:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">120</span><span class="op">)</span> <span class="co"># stratigraphic positions</span></span>
<span><span class="fu"><a href="../reference/get_time.html">get_time</a></span><span class="op">(</span><span class="va">my_adm</span>,</span>
<span>         h <span class="op">=</span> <span class="va">h</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1380552 1.2704696</span></span></code></pre></div>
<p>Conversely, to determine what parts of the section are deposited as a
specific time, use</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">1.4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_height.html">get_height</a></span><span class="op">(</span><span class="va">my_adm</span>,</span>
<span>           t <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 39.13951       NA</span></span></code></pre></div>
<p>Here, the <code>NA</code> indicates that the time 1.4 coincides with
erosion. If you want to know the stratigraphic position of the hiatus
that coincides with that time, use the option
<code>destructive = FALSE</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">1.4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_height.html">get_height</a></span><span class="op">(</span><span class="va">my_adm</span>,</span>
<span>           t <span class="op">=</span> <span class="va">t</span>,</span>
<span>           destructive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  39.13951 126.27764</span></span></code></pre></div>
<p>Alternatively, you can also use the wrappers
<code>strat_to_time</code> and <code>time_to_strat</code> for the
transformation. For expanded modeling features please use the
<code>StratPal</code> package (<a href="https://github.com/MindTheGap-ERC/StratPal" class="external-link">Github</a> | <a href="https://mindthegap-erc.github.io/StratPal/" class="external-link">Webpage</a> | <a href="https://cran.r-project.org/package=StratPal" class="external-link">CRAN</a>). It
provides more biological context and utility functions to build modeling
pipelines that include ecological, taphonomic, stratigraphic, and
evolutionary effects.</p>
</div>
<div class="section level5">
<h5 id="phylogenetic-trees">Phylogenetic trees<a class="anchor" aria-label="anchor" href="#phylogenetic-trees"></a>
</h5>
<p>The <code>admtools</code> package can transform complex objects
between the time and stratigraphic domain. This is done using the
functions <code>strat_to_time</code> and <code>time_to_strat</code>.</p>
<p>As an example, we transform a chronogram (a phylogenetic tree where
branch length represents time). An example tree following the
birth-death model is stored with the package as the variable
<code>timetree</code>. See <code><a href="../reference/timetree.html">?timetree</a></code> for details on how
this tree was generated.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install.packages("ape") Package for analyses of phylogenetics and evolution</span></span>
<span><span class="co"># see ?ape::rlineage for help</span></span>
<span><span class="co">#set.seed(1)</span></span>
<span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></span><span class="op">(</span><span class="va">timetree</span><span class="op">)</span> <span class="co"># see also ?ape::plot.phylo</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Time [Myr]"</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="admtools_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>You can transform the tree using <code>time_to_strat</code>:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_in_strat_domain</span> <span class="op">=</span> <span class="fu"><a href="../reference/time_to_strat.html">time_to_strat</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">timetree</span>,</span>
<span>                                     x <span class="op">=</span> <span class="va">my_adm</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the resulting tree along the stratigraphic column shows how
the evolutionary relationships would be preserved 2 km offshore in the
simulated carbonate platform:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></span><span class="op">(</span><span class="va">tree_in_strat_domain</span>, direction <span class="op">=</span> <span class="st">"upwards"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Stratigraphic Height [m]"</span>,</span>
<span>      side <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      line <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="admtools_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="lists-and-timestratigraphic-series">Lists and time/stratigraphic series<a class="anchor" aria-label="anchor" href="#lists-and-timestratigraphic-series"></a>
</h5>
<p><em>admtools</em> can transform lists from the time to the height
domain and vice versa given they have elements with names <code>h</code>
or <code>t</code>. These lists can be interpreted as time/stratigraphic
series, where times and stratigraphic positions are associated with
measured values. Note that these are not <code>ts</code> objects as used
by the <code>stats</code> package, as they will be generally
heterodistant due to the irregular nature of the age-depth
transformation.</p>
<p>As example, we simulate trait evolution over 2 Myr using a Brownian
motion, and transform the simulation into the stratigraphic domain.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> <span class="co"># times</span></span>
<span><span class="va">BM</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co">#" Simulate Brownian motion at times t</span></span>
<span>  <span class="va">li</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"t"</span> <span class="op">=</span> <span class="va">t</span>,</span>
<span>            <span class="st">"y"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">li</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timelist"</span>, <span class="st">"list"</span><span class="op">)</span> <span class="co"># assign class `timelist` for easy plotting, see ?plot.timelist</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">li</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">evo_list</span> <span class="op">=</span> <span class="fu">BM</span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">evo_list</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time [Myr]"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Trait Value"</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="admtools_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat_list</span> <span class="op">=</span> <span class="fu"><a href="../reference/time_to_strat.html">time_to_strat</a></span><span class="op">(</span>obj <span class="op">=</span> <span class="va">evo_list</span>,</span>
<span>                            x <span class="op">=</span> <span class="va">my_adm</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">strat_list</span>,</span>
<span>     orientation <span class="op">=</span> <span class="st">"lr"</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Stratigraphic Height [m]"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Trait Value"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Trait Evolution 2 km Offshore"</span><span class="op">)</span></span></code></pre></div>
<p><img src="admtools_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>Note the jump in traits generated by the erosional interval in
<code>my_adm</code>. Both <code>time_to_strat</code> and
<code>strat_to_time</code> return <code>stratlist</code> and
<code>timelist</code> objects when applied to lists. These are like
ordinary lists, but come with simplified plotting optionality, see
<code><a href="../reference/plot.stratlist.html">?plot.stratlist</a></code> and <code><a href="../reference/plot.timelist.html">?plot.timelist</a></code> for
details.</p>
<p>For expanded modeling features with biological context, please use
the <code>StratPal</code> package (<a href="https://github.com/MindTheGap-ERC/StratPal" class="external-link">Github</a> | <a href="https://mindthegap-erc.github.io/StratPal/" class="external-link">Webpage</a> | <a href="https://cran.r-project.org/package=StratPal" class="external-link">CRAN</a>). It
provides light wrappers around <code>admtools</code> and out of the box
modeling of trait evolution.</p>
</div>
<div class="section level5">
<h5 id="numeric-vectors">Numeric vectors<a class="anchor" aria-label="anchor" href="#numeric-vectors"></a>
</h5>
<p>Numeric vectors can be transformed using <code>time_to_strat</code>
and <code>strat_to_time</code> too. These are essentially high level
wrappers around <code>get_height</code> and <code>get_time</code>. See
functions <code>time_to_strat.numeric</code> and
<code>strat_to_time.numeric</code> for details.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="further-information">Further information<a class="anchor" aria-label="anchor" href="#further-information"></a>
</h3>
<p>For an overview of the structure of the <code>admtools</code> package
and the classes used therein see</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"admtools_doc"</span><span class="op">)</span></span></code></pre></div>
<p>For details on plotting ADMs see</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">"adm_plotting)</span></span></code></pre></div>
<p>For information on estimating age-depth models from sedimentation
rates, see</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"adm_from_sedrate"</span><span class="op">)</span></span></code></pre></div>
<p>For information on estimating age-depth models from tracer contents
of rocks and sediments, see</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"adm_from_trace_cont"</span><span class="op">)</span></span></code></pre></div>
<p>For information on depth-depth curves and correlation see</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"correlation"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="References">References<a class="anchor" aria-label="anchor" href="#References"></a>
</h3>
<ul>
<li><p>Burgess, Peter. “CarboCAT: A cellular automata model of
heterogeneous carbonate strata.” Computers &amp; geosciences 53 (2013):
129-140. <a href="https://doi.org/10.1016/j.cageo.2011.08.026" class="external-link">DOI:
10.1016/j.cageo.2011.08.026</a></p></li>
<li><p>Burgess, Peter. “CarboCAT Lite v1.0.1”. Zenodo 2023. <a href="https://doi.org/10.5281/zenodo.8402578" class="external-link">DOI:
10.5281/zenodo.8402578</a></p></li>
<li><p>Hohmann, Niklas; Koelewijn, Joël R.; Burgess, Peter; Jarochowska,
Emilia. 2024. “Identification of the mode of evolution in incomplete
carbonate successions.” BMC Ecology and Evolution 24, 113. <a href="https://doi.org/10.1186/s12862-024-02287-2" class="external-link uri">https://doi.org/10.1186/s12862-024-02287-2</a>.</p></li>
<li><p>Hohmann, Niklas, Koelewijn, Joël R.; Burgess, Peter; Jarochowska,
Emilia. 2023. “Identification of the Mode of Evolution in Incomplete
Carbonate Successions - Supporting Data.” Open Science Framework. <a href="https://doi.org/10.17605/OSF.IO/ZBPWA" class="external-link uri">https://doi.org/10.17605/OSF.IO/ZBPWA</a>, published under
the <a href="https://creativecommons.org/licenses/by/4.0/" class="external-link">CC-BY 4.0</a>
license.</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Niklas Hohmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
