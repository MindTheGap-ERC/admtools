<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="admtools">
<title>Estimating Age-Depth Models from Sedimentation Rates • admtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating Age-Depth Models from Sedimentation Rates">
<meta property="og:description" content="admtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">admtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/admtools.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/adm_from_sedrate.html">Estimating Age-Depth Models from Sedimentation Rates</a>
    <a class="dropdown-item" href="../articles/adm_from_trace_cont.html">Estimating Age-Depth Models from Tracer Contents of Rocks and Sediments</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MindTheGap-ERC/admtools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Estimating Age-Depth Models from Sedimentation Rates</h1>
                        <h4 data-toc-skip class="author">Niklas
Hohmann</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MindTheGap-ERC/admtools/blob/HEAD/vignettes/adm_from_sedrate.Rmd" class="external-link"><code>vignettes/adm_from_sedrate.Rmd</code></a></small>
      <div class="d-none name"><code>adm_from_sedrate.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette explains how to estimate age-depth models (ADMs) from
sedimentation rates using the function
<code>sedrate_to_multiadm</code></p>
<div class="section level3">
<h3 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a>
</h3>
<p>The <code>sedrate_to_multiadm</code> function estimates age-depth
models from sedimentation rates and position and timing of tie points.
It takes the following inputs that encode user knowledge:</p>
<ul>
<li><p><code>h_tp</code> : a function encoding stratigraphic positions
of tie points</p></li>
<li><p><code>t_tp</code> : a function encoding times of the tie
points</p></li>
<li><p><code>sed_rate_gen</code>: a function encoding how sedimentation
rates change with stratigraphic positions. This information can for
example be derived from cyclostratigraphic analyses.</p></li>
</ul>
<p>In addition, it takes the following inputs that specify the
estimation procedure:</p>
<ul>
<li><p><code>h</code> : vector of heights where the ADM is
determined</p></li>
<li><p><code>no_of_rep</code>: integer, number of age-depth models
determined</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="coding-user-knowledge">Coding user knowledge<a class="anchor" aria-label="anchor" href="#coding-user-knowledge"></a>
</h3>
<div class="section level4">
<h4 id="tie-points">Tie points<a class="anchor" aria-label="anchor" href="#tie-points"></a>
</h4>
<p>Times and heights of tie points are coded via the functions
<code>t_tp</code> (timing) and <code>h_tp</code> (height) that take no
inputs. They serve as wrappers around user-defined procedures that
reflect uncertainties around tie points. Every time <code>t_tp</code>
and <code>h_tp</code> are evaluated, they return possible values for the
tie points. Writing these functions requires some effort, but it allows
the user to hand over arbitrarily complex uncertainties of the tie
points to the <code>sedrate_to_multiadm</code> function.</p>
<p>The function for the timing of the tie points must return a named
vector with names “t1” (timing of first tie point) and “t2” (timing of
second tie point). “t1” must be smaller than “t2”.</p>
<p>For this example, I assume that the first tie point follows a normal
distribution with mean - 20 Myr before present and standard deviation
0.5 Myr. The timing of the second tie point is bimodal and given as an
equal mixture of two normal distributions with means - 5 and - 7 Myr
years before present and standard deviations of 0.1 and 0.3 Myr years.
This is implemented as follows in <code>t_tp</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_tp</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># first tie point</span></span>
<span>  <span class="va">t1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="op">-</span><span class="fl">20</span> , sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># second tie point</span></span>
<span>  <span class="va">d1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="co"># fair coin flip for mixture</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">d1</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">t2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span>  <span class="op">-</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">t2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span>  <span class="op">-</span> <span class="fl">7</span>, sd <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t1"</span> <span class="op">=</span> <span class="va">t1</span>, <span class="st">"t2"</span> <span class="op">=</span> <span class="va">t2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Sampling from <code>t_tp</code> yields the following empirical
distribution for the tie points:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">no_of_samples</span> <span class="op">=</span> <span class="fl">10000</span></span>
<span><span class="co"># Evaluate timing of tie points</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">no_of_samples</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">t_tp</span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">"t1"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     freq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time before present [Myr]"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Timing of first tie point"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">no_of_samples</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">t_tp</span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">"t2"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     freq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time before present [Myr]"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Timing of second tie point"</span><span class="op">)</span></span></code></pre></div>
<p><img src="adm_from_sedrate_files/figure-html/unnamed-chunk-3-1.png" width="50%"><img src="adm_from_sedrate_files/figure-html/unnamed-chunk-3-2.png" width="50%"></p>
<p>The function for the heights of the tie points must return a named
vector with entries <code>h1</code> and <code>h2</code>, corresponding
to the heights of the first (lower) and second (upper) tie point.
<code>h1</code> must be smaller than <code>h2</code>.</p>
<p>For this example, I assume the stratigraphic positions of the tie
points is known without uncertainty, and are at 10 and 85 m
stratigraphic height.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h_min</span> <span class="op">=</span> <span class="fl">10</span> <span class="co"># height of tie point 1</span></span>
<span><span class="va">h_max</span> <span class="op">=</span> <span class="fl">85</span> <span class="co"># height of tie point 2</span></span></code></pre></div>
<p><code>h_tp</code> is then implemented as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h_tp</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"h1"</span> <span class="op">=</span> <span class="va">h_min</span>, </span>
<span>           <span class="st">"h2"</span> <span class="op">=</span> <span class="va">h_max</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>When evaluated, this function returns the stratigraphic positions of
the tie points:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Evaluate stratigraphic positions of tie points</span></span>
<span><span class="fu">h_tp</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; h1 h2 </span></span>
<span><span class="co">#&gt; 10 85</span></span></code></pre></div>
<p>This is a lot of effort to simply encode fixed stratigraphic
positions of tie points. However, it allows to implement arbitrary
uncertainties on the position of the tie points if needed.</p>
</div>
<div class="section level4">
<h4 id="coding-sedimentation-rates">Coding Sedimentation Rates<a class="anchor" aria-label="anchor" href="#coding-sedimentation-rates"></a>
</h4>
<p>Sedimentation rates are specified via a function
<code>sed_rate_gen</code> that takes no inputs. It serves as wrapper for
user-defined procedures that specify uncertainties in sedimentation
rates. <code>sed_rate_gen</code> is a “function factory”: every time it
is evaluated, it returns another function that is one potential
sedimentation rate scenario. Writing this function factory requires some
effort, but it allows the user to specify how uncertainties of
sedimentation rates are expressed in the section, and implement
arbitrarily complex distributions. The idea behind this is that
sedimentation rates are considered stochastic processes. Every time
<code>sed_rate_gen</code> is evaluated, it returns one sample path from
this process.</p>
<p>The functions returned by <code>sed_rate_gen</code> must return
strictly positive values - negative sedimentation rates can not be
observed in the section.</p>
<p>I use a simple sedimentation rate model, where only upper and lower
bounds on sedimentation rates in the section are known. Between these
limits, I assume a uniform distribution.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># limits on sed. rates</span></span>
<span><span class="va">lower_limit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span>,<span class="fl">0.1</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">upper_limit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># strat intervals where sed rates are defined</span></span>
<span><span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h_min</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">30</span>,<span class="fl">75</span>, <span class="fl">80</span>, <span class="va">h_max</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Based on these parameters, the sedimentation rate function factory is
defined as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define function factory</span></span>
<span><span class="va">sed_rate_fun</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># draw sed rates from uniform distribution</span></span>
<span>  <span class="va">aa_1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">lower_limit</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">upper_limit</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">lower_limit</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">upper_limit</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">lower_limit</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">upper_limit</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">lower_limit</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">upper_limit</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">aa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">aa_1</span>, <span class="va">aa_1</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="co"># define sed rate "realization" based on samples from uniform distribution</span></span>
<span> <span class="va">sed_rate_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approxfun</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">s</span>,</span>
<span>                          y <span class="op">=</span> <span class="va">aa</span>,</span>
<span>                          method <span class="op">=</span> <span class="st">"constant"</span><span class="op">)</span></span>
<span> <span class="co"># return the function</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">sed_rate_fun</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To visualize, here are three sedimentation rates generated by the
“sedimentation rate function factory” <code>sed_rate_fun</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NULL</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h_min</span>, <span class="va">h_max</span><span class="op">)</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">upper_limit</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Stratigraphic Height [m]"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Sedimentation Rate"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">no_of_sedrates</span> <span class="op">=</span> <span class="fl">3</span> <span class="co"># no. of sed rates displayed</span></span>
<span><span class="va">h</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">h_min</span>,<span class="va">h_max</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="co"># strat. positions where sed rates are plotted</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">no_of_sedrates</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># generate sed rate from the factory</span></span>
<span>  <span class="va">sed_rate_sample</span> <span class="op">=</span> <span class="fu">sed_rate_fun</span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># plot sed rate in the section</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">h</span>, <span class="fu">sed_rate_sample</span><span class="op">(</span><span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="adm_from_sedrate_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>All sedimentation rates generated by <code>sed_rate_fun</code> will
be different, because they are determined by random numbers.</p>
</div>
<div class="section level4">
<h4 id="estimating-the-age-depth-models">Estimating the Age-Depth Models<a class="anchor" aria-label="anchor" href="#estimating-the-age-depth-models"></a>
</h4>
<p>The function <code>sedrate_to_multiadm</code> estimates the age-depth
model from the inputs. Here, I determine the age-depth models every
meter, and generate 10 ADMs</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">h_min</span>,<span class="va">h_max</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># strat. positions where ADMs are estimated</span></span>
<span><span class="va">no_of_rep</span> <span class="op">=</span> <span class="fl">10</span> <span class="co"># no. of ADMs estimated</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_adm</span> <span class="op">=</span> <span class="fu"><a href="../reference/sedrate_to_multiadm.html">sedrate_to_multiadm</a></span><span class="op">(</span>h_tp <span class="op">=</span> <span class="fu">h_tp</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                             t_tp <span class="op">=</span> <span class="fu">t_tp</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                             sed_rate_gen <span class="op">=</span> <span class="va">sed_rate_fun</span>,</span>
<span>                             h <span class="op">=</span> <span class="va">h</span>,</span>
<span>                             no_of_rep <span class="op">=</span> <span class="va">no_of_rep</span><span class="op">)</span></span></code></pre></div>
<p>It generates a portfolio of age-depth models combined into the
variable <code>madm</code> (multi-adm). <code>madm</code> is an object
of class multiadm.</p>
<p><img src="adm_from_sedrate_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>These are 10 age-depth models generated by the
<code>sedrate_to_adm</code> function, which are all equally likely
candidates for the age-depth relationship in the section. Running
summary statistics on large number of age-depth models (increasing the
<code>no_of_rep</code> input variable) gives an assessment of the
uncertainties of the age-depth relationship. This can be used to
generate the classic envelopes of uncertainty (95 % CI).</p>
</div>
</div>
<div class="section level3">
<h3 id="further-information">Further information<a class="anchor" aria-label="anchor" href="#further-information"></a>
</h3>
<p>For information on estimating age-depth models from tracer contents
of rocks and sediments, see</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"adm_from_trace_cont"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Niklas Hohmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
