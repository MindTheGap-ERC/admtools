<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimating Age-Depth Models from Sedimentation Rates • admtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating Age-Depth Models from Sedimentation Rates">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">admtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/admtools.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/adm_from_sedrate.html">Estimating Age-Depth Models from Sedimentation Rates</a></li>
    <li><a class="dropdown-item" href="../articles/adm_from_trace_cont.html">Estimating Age-Depth Models from Tracer Contents of Rocks and Sediments</a></li>
    <li><a class="dropdown-item" href="../articles/adm_plotting.html">Plotting Age-Depth Models</a></li>
    <li><a class="dropdown-item" href="../articles/admtools_doc.html">Structure and classes of the admtools package</a></li>
    <li><a class="dropdown-item" href="../articles/correlation.html">Depth-depth curves and correlation</a></li>
    <li><a class="dropdown-item" href="../articles/FossilSim_integration.html">Integration with the FossilSim and paleotree packages</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MindTheGap-ERC/admtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimating Age-Depth Models from Sedimentation Rates</h1>
                        <h4 data-toc-skip class="author">Niklas
Hohmann</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MindTheGap-ERC/admtools/blob/v0.6.0/vignettes/adm_from_sedrate.Rmd" class="external-link"><code>vignettes/adm_from_sedrate.Rmd</code></a></small>
      <div class="d-none name"><code>adm_from_sedrate.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette explains how to estimate age-depth models (ADMs) from
sedimentation rates and tie points using the function
<code>sedrate_to_multiadm</code></p>
<div class="section level3">
<h3 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a>
</h3>
<p>The <code>sedrate_to_multiadm</code> function estimates age-depth
models from sedimentation rates and position and timing of tie points.
It takes the following inputs that encode user knowledge:</p>
<ul>
<li><p><code>h_tp</code> : a function encoding stratigraphic positions
of tie points</p></li>
<li><p><code>t_tp</code> : a function encoding times of the tie
points</p></li>
<li><p><code>sed_rate_gen</code>: a function encoding how sedimentation
rates change with stratigraphic positions. This information can for
example be derived from cyclostratigraphic analyses.</p></li>
</ul>
<p>In addition, it takes the following inputs that specify the
estimation procedure:</p>
<ul>
<li><p><code>h</code> : vector of heights where the ADM is
determined</p></li>
<li><p><code>no_of_rep</code>: integer, number of runs</p></li>
</ul>
<p>Additional parameters that determine the numeric behavior of the
integration method used are <code>subdivisions</code> and
<code>stop.on.error</code>. The parameters <code>T_unit</code> and
<code>L_unit</code> can be used to associate time and length units with
the generated age-depth model.</p>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>We construct an age depth model for a section of 10 m thickness where
upper and lower bounds on sedimentation rates are available. This is a
simplified example, details on how arbitrary sedimentation rates can be
encoded can be found below.</p>
<div class="section level4">
<h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>We start by defining the section as well as lower and upper bounds on
sedimentation rates</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h_min</span> <span class="op">=</span> <span class="fl">2</span> <span class="co"># lower boundary of the section</span></span>
<span><span class="va">h_max</span> <span class="op">=</span> <span class="fl">10</span> <span class="co"># upper boundary of the section</span></span>
<span><span class="va">T_unit</span> <span class="op">=</span> <span class="st">"Myr"</span></span>
<span><span class="va">L_unit</span> <span class="op">=</span> <span class="st">"m"</span></span></code></pre></div>
<p>We want to know the age-depth model every 10 cm, so we define</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">h_min</span>, <span class="va">h_max</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="tie-points">Tie points<a class="anchor" aria-label="anchor" href="#tie-points"></a>
</h4>
<p>We assume there is one tie point in the section at 5 m height, and
its mean age is 66 years with a standard deviation of 0.25 Myr</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h1</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="va">mean_age</span> <span class="op">=</span> <span class="op">-</span><span class="fl">66</span></span>
<span><span class="va">sd</span> <span class="op">=</span> <span class="fl">0.25</span> </span></code></pre></div>
<p>Then the tie point timing is given by</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_tp</span> <span class="op">=</span> <span class="fu"><a href="../reference/tp_time_norm.html">tp_time_norm</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean_age</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span></code></pre></div>
<p>and the tie point height is given by</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h_tp</span> <span class="op">=</span> <span class="fu"><a href="../reference/tp_height_det.html">tp_height_det</a></span><span class="op">(</span>heights <span class="op">=</span> <span class="va">h1</span><span class="op">)</span></span></code></pre></div>
<p>Every time <code>t_tp</code> is evaluated, it returns one possible
time of the tie points. Similarly, every time <code>h_tp</code> is
evaluated, it returns the stratigraphic position of the tie point (which
is deterministic in this case):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">h_tp</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="fu">t_tp</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -66.35001</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sedimentation-rates">Sedimentation rates<a class="anchor" aria-label="anchor" href="#sedimentation-rates"></a>
</h4>
<p>We assume the following upper and lower limits for sedimentation
rates:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sedrate_max_y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">sedrate_max_x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">sedrate_min_y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">7</span>,<span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">sedrate_min_x</span> <span class="op">=</span> <span class="va">sedrate_max_x</span> </span></code></pre></div>
<p>Here, <code>sedrate_max_y[i]</code> is the upper limit on
sedimentation rate at <code>sedrate_max_x[i]</code> (mutatis mutandis
for <code>sedrate_min</code>). Between these points, we assume linear
interpolation. This is done by the function
<code>sed_rate_gen_from_bounds</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sedrate</span> <span class="op">=</span> <span class="fu"><a href="../reference/sed_rate_gen_from_bounds.html">sed_rate_gen_from_bounds</a></span><span class="op">(</span>h_l <span class="op">=</span> <span class="va">sedrate_min_x</span>,</span>
<span>                                   s_l <span class="op">=</span> <span class="va">sedrate_min_y</span>,</span>
<span>                                   h_u <span class="op">=</span> <span class="va">sedrate_max_x</span>,</span>
<span>                                   s_u <span class="op">=</span> <span class="va">sedrate_max_y</span>,</span>
<span>                                   rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Because the sedimentation rates are uncertain, functions returned by
<code>sedrate</code> will differ each time the function is evaluated. As
an example, we plot three different sample paths (realizations) of the
sedimentation rate through the section:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NULL</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">h</span><span class="op">)</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sedrate_max_y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Height [m]"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Sedimentation Rate [m/Myr]"</span><span class="op">)</span></span>
<span><span class="va">no_sedrates</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">no_sedrates</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">sedrate_sample</span> <span class="op">=</span> <span class="fu">sedrate</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">h</span>, <span class="fu">sedrate_sample</span><span class="op">(</span><span class="va">h</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="adm_from_sedrate_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>These sedimentation rates assume sedimentation rates are drawn from a
uniform distribution between the upper and lower limits of sedimentation
rate provided by the user. This is done at random locations determined
according to a Poisson point process with rate <code>rate</code>.</p>
</div>
<div class="section level4">
<h4 id="estimate-age-depth-model">Estimate age depth model<a class="anchor" aria-label="anchor" href="#estimate-age-depth-model"></a>
</h4>
<p>With tie points and sedimentation rates specified, we can now
estimate the age depth model using</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_adm</span> <span class="op">=</span> <span class="fu"><a href="../reference/sedrate_to_multiadm.html">sedrate_to_multiadm</a></span><span class="op">(</span>h_tp <span class="op">=</span> <span class="va">h_tp</span>,</span>
<span>                             t_tp <span class="op">=</span> <span class="va">t_tp</span>,</span>
<span>                             sed_rate_gen <span class="op">=</span> <span class="va">sedrate</span>,</span>
<span>                             h <span class="op">=</span> <span class="va">h</span>,</span>
<span>                             T_unit <span class="op">=</span> <span class="va">T_unit</span>,</span>
<span>                             L_unit <span class="op">=</span> <span class="va">L_unit</span><span class="op">)</span></span></code></pre></div>
<p>The age-depth model can be plotted using</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_adm</span><span class="op">)</span></span></code></pre></div>
<p><img src="adm_from_sedrate_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>You can extract mean, median, and quantile age-depth models using
<code>mean_adm</code>, <code>median_adm</code> and
<code>quantile_adm</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_adm</span> <span class="op">=</span> <span class="fu"><a href="../reference/mean_adm.html">mean_adm</a></span><span class="op">(</span><span class="va">my_adm</span>, <span class="va">h</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mean_adm</span><span class="op">)</span></span></code></pre></div>
<p><img src="adm_from_sedrate_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="coding-tie-points">Coding tie points<a class="anchor" aria-label="anchor" href="#coding-tie-points"></a>
</h3>
<div class="section level4">
<h4 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h4>
<p>Times and heights of tie points are coded via the functions
<code>t_tp</code> (timing) and <code>h_tp</code> (height) that take no
inputs. They serve as wrappers around user-defined procedures that
reflect uncertainties around tie points. Every time <code>t_tp</code>
and <code>h_tp</code> are evaluated, they return possible values for the
tie points. Conceptually, both <code>t_tp</code>and <code>h_tp</code>
are user implemented random number generators that draw from the
distributions of tie points. Writing these functions requires some
effort, but it allows the user to hand over arbitrarily complex
uncertainties of the tie points to the <code>sedrate_to_multiadm</code>
function.</p>
</div>
<div class="section level4">
<h4 id="wrappers">Wrappers<a class="anchor" aria-label="anchor" href="#wrappers"></a>
</h4>
<p>Multiple wrappers are available to simplify coding tie points:</p>
<ul>
<li><p><code>tp_height_det</code> for specifying deterministic
stratigraphic heights</p></li>
<li><p><code>tp_time_det</code> for specifying deterministic time
points</p></li>
<li><p><code>tp_time_floating_scale</code> to encode time tie points for
floating time scale</p></li>
<li><p><code>tp_time_norm</code> for normally distributed tie points in
time</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="manually-coding-tie-points">Manually coding tie points<a class="anchor" aria-label="anchor" href="#manually-coding-tie-points"></a>
</h4>
<p>Both <code>t_tp</code> and <code>h_tp</code> must return strictly
ordered numeric vectors of times/heights. This means that it is the
users responsibility to avoid inversions of times/heights.</p>
<p>As an example, I assume the stratigraphic positions of the tie points
are known without uncertainty, and are at 10 and 20 m stratigraphic
height.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h_min</span> <span class="op">=</span> <span class="fl">10</span> <span class="co"># stratigraphic height of lower tie point [m]</span></span>
<span><span class="va">h_max</span> <span class="op">=</span> <span class="fl">20</span> <span class="co"># stratigraphic height of upper tie point [m]</span></span></code></pre></div>
<p><code>h_tp</code> is then implemented as follows:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h_tp</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h_min</span>, <span class="va">h_max</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>When evaluated, this function returns the stratigraphic positions of
the tie points:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">h_tp</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10 20</span></span></code></pre></div>
<p>Note that the <code>h_tp</code> defined here is a synonym for
<code>h_tp = tp_height_det(c(h_min, h_max))</code>.</p>
<p>For a more complex example, I assume that the timing of the first tie
point follows a normal distribution with mean 0 and standard deviation
0.5. For the second tie point, only maximum and minimum time is
available. Due to the lack of information, I assume a uniform
distribution between the minimum (9) and the maximum (11). This is
implemented as follows in <code>t_tp</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_tp</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">repeat</span><span class="op">{</span> </span>
<span>    <span class="co"># timing first tie point</span></span>
<span>    <span class="va">t1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="co"># timing second tie point</span></span>
<span>    <span class="va">t2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, min <span class="op">=</span> <span class="fl">9</span>, max <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">t1</span> <span class="op">&lt;</span> <span class="va">t2</span><span class="op">)</span><span class="op">{</span> <span class="co"># if order is correct, return values</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">t1</span>, <span class="va">t2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">t_tp</span><span class="op">(</span><span class="op">)</span> <span class="co"># evaluating the function returns a random pair of times drawn from the specified distribution</span></span>
<span><span class="co">#&gt; [1]  0.2729596 10.6250840</span></span></code></pre></div>
<p>Using Myr as time unit, the distribution of times for the tie points
is as follows:</p>
<p><img src="adm_from_sedrate_files/figure-html/unnamed-chunk-17-1.png" width="700"><img src="adm_from_sedrate_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="coding-sedimentation-rates">Coding sedimentation rates<a class="anchor" aria-label="anchor" href="#coding-sedimentation-rates"></a>
</h3>
<div class="section level4">
<h4 id="background-1">Background<a class="anchor" aria-label="anchor" href="#background-1"></a>
</h4>
<p>Mathematically, sedimentation rates are assumed to be stochastic
processes. With each iteration of the estimation procedure, a sample
path is generated from the stochastic processes. This sample path
reflects one possible change of sedimentation rate in the section, given
our uncertainties about it.</p>
<p>Computationally, this is implemented using <em>function
factories</em>, which are functions that return functions. A function
factory defines a stochastic process, and each function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
generated by a function factory is a sample path. In turn,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math>
returns the value of the sample path at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
.</p>
<p>Here, function factories are used as complex random number
generators: Instead of returning one or multiple random numbers, they
return a random function.</p>
</div>
<div class="section level4">
<h4 id="wrappers-1">Wrappers<a class="anchor" aria-label="anchor" href="#wrappers-1"></a>
</h4>
<p>Available wrappers to define sedimentation rates are</p>
<ul>
<li><p><code>sed_rate_gen_from_bounds</code> : generate sed. rate from
upper and lower bounds on the sedimentation rate (see above)</p></li>
<li><p><code>sed_rate_from_matrix</code>: specify sedimentation rate
based on matrix, to be used in conjunction with
<code>get_data_from_eTimeOpt</code>. This allows to have sedimentation
rates change both at deterministic and randomized heights, see
<code><a href="../reference/sed_rate_from_matrix.html">?sed_rate_from_matrix</a></code> for details.</p></li>
<li><p><code>sed_rate_gen_gamma</code> : generate sed. rate based on
gamma distribution.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="manually-coding-sedimentation-rates">Manually coding sedimentation rates<a class="anchor" aria-label="anchor" href="#manually-coding-sedimentation-rates"></a>
</h4>
<p>Sedimentation rates must be coded as function factories, i.e.,
functions that return functions. They must be able to take vector inputs
and return a vector of the same length as output, and always return
strictly positive values.</p>
<p>As example, I use a simple sedimentation rate model, where only upper
and lower bounds on sedimentation rates in the section are known.
Between these limits, I assume a uniform distribution.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h_min</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="va">h_max</span> <span class="op">=</span> <span class="fl">90</span></span>
<span><span class="co"># limits on sed. rates </span></span>
<span><span class="va">lower_limit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span>,<span class="fl">0.1</span>,<span class="fl">10</span><span class="op">)</span> </span>
<span><span class="va">upper_limit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">12</span><span class="op">)</span>  </span>
<span><span class="co"># strat intervals where sed rates are defined </span></span>
<span><span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h_min</span>, <span class="fl">30</span>,<span class="fl">65</span>, <span class="fl">80</span>, <span class="va">h_max</span><span class="op">)</span></span></code></pre></div>
<p>Based on these parameters, the sedimentation rate function factory is
defined as follows:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define function factory </span></span>
<span><span class="va">sed_rate_fun</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>   </span>
<span>  <span class="co"># draw sed rates from uniform distribution  </span></span>
<span>  <span class="va">aa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lower_limit</span><span class="op">)</span>, min <span class="op">=</span> <span class="va">lower_limit</span>, max <span class="op">=</span> <span class="va">upper_limit</span><span class="op">)</span>   </span>
<span>  <span class="co"># define sed rate "realization" based on samples from uniform distribution </span></span>
<span>  <span class="va">sed_rate_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approxfun</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">s</span>, </span>
<span>                           y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">aa</span>, <span class="va">aa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">aa</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                           method <span class="op">=</span> <span class="st">"constant"</span>, </span>
<span>                           rule <span class="op">=</span> <span class="fl">2</span>,  </span>
<span>                          f <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">sed_rate_fun</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Note that the inner function is a function of one variable (height),
while the outer function takes no arguments - it simply returns the
inner function. To visualize this, let’s plot three sedimentation rates
generated by the “sedimentation rate function factory”
<code>sed_rate_fun</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NULL</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h_min</span>, <span class="va">h_max</span><span class="op">)</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">upper_limit</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Stratigraphic Height [m]"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Sedimentation Rate"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">no_of_sedrates</span> <span class="op">=</span> <span class="fl">3</span> <span class="co"># no. of sed rates displayed</span></span>
<span><span class="va">h</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">h_min</span>,<span class="va">h_max</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="co"># strat. positions where sed rates are plotted</span></span>
<span><span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">no_of_sedrates</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># generate sed rate from the factory</span></span>
<span>  <span class="va">sed_rate_sample</span> <span class="op">=</span> <span class="fu">sed_rate_fun</span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># plot sed rate in the section</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">h</span>, <span class="fu">sed_rate_sample</span><span class="op">(</span><span class="va">h</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="adm_from_sedrate_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>All sedimentation rates generated by <code>sed_rate_fun</code> will
be different, because they are determined by random numbers.</p>
</div>
</div>
<div class="section level3">
<h3 id="further-information">Further information<a class="anchor" aria-label="anchor" href="#further-information"></a>
</h3>
<p>For information on estimating age-depth models from tracer contents
of rocks and sediments, see</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"adm_from_trace_cont"</span><span class="op">)</span></span></code></pre></div>
<p>For details on plotting ADMs see</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">"adm_plotting)</span></span></code></pre></div>
<p>For an overview of the structure of the <code>admtools</code> package
and the classes used therein see</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"admtools_doc"</span><span class="op">)</span></span></code></pre></div>
<p>For an overview over all available vignettes for the
<code>admtools</code> package use</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"admtools"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Niklas Hohmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
