---
title: "admtools: Getting Started"
output: rmarkdown::html_vignette
author: "Niklas Hohmann"
vignette: >
  %\VignetteIndexEntry{admtools: Getting Started}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, echo=FALSE}
library(admtools)
```

# Introduction

This vignette is an introduction to the _admtools_ package.

## Loading the package

First, load the package using

```{r}
library(admtools)
```

This makes all functions in the package available.

As example data we use outputs from CarboCAT Lite, a model of carbonate platform growth (Burgess 2013, 2023). This data is automatically loaded in the background by the package. To inspect it, you can load it into your workspace via

```{r}
data("CarboCatLite_data")
```

## Defining age-depth models

The standard constructor for age-depth models is _tp_2_adm_ ("tiepoint to age-depth model"). It returns an _adm_ (age-depth model) object. This object combines information of stratigraphic heights and times and erosive interval. It allows to transform data between the stratigraphic and the time domain, and indentify which data is destroyed due to hiatuses.
We use the timing and stratigraphic positions of tie points to construct an age-depth model, and use the option to directly associate length and time units with it.

```{R}
# see ?tp_2_adm for detailed documentation
my_adm = tp_2_adm(t = CarboCATLite_data$time_myr,
                  h = CarboCATLite_data$height_2_km_offshore_m,
                  L_unit = "m",
                  T_unit = "Myr")
```

You can use _summary_ to get a quick overview of the properties of the age-depth model
```{R}
summary(my_adm)
```
Use the functions _get_total_duration_, _get_total_thickness_, _get_completeness_, and _get_hiat_no_ extract that information directly from the age-depth model.

To get a visual representation, we plot it, and highlight hiatuses in red

```{R}
# see ?plot.adm for plotting options for adm objects
plot(my_adm,
     col_hiat = "red",
     lwd_cons = 3)
```

The function _is_destructive_ can be used to examine whether time points coincide with hiatuses:

```{R}
is_destructive(adm = my_adm,
               t = c(0.1,0.5)) 
```

## Transforming data between time and stratigraphic domain

The functions _get_height_ and _get_time_ are the workhorses to transform data using age-depth models.

* _get_time_ takes and adm object and vector of heights _h_  (stratigraphic positions), and returns a vector of times
* _get_height_ takes an adm object and vector of times and returns a vector of associated positions

As example, say we want to know the time of deposition of the following stratigraphic positions:

```{r}
h = c(30,120) # stratigraphic positions
get_time(adm = my_adm,
             h = h)
```
Conversely, to determine what parts of the section are deposited as a specific time, use
```{r}
t = c(0.2,1.4)
get_height(adm = my_adm,
           t = t)
```
Here, the _NA_ indicates that the time 1.4 coincides with erosion. If you want to know the stratigraphic position of the hiatus that coincides with that time, use the option _destructive = FALSE_:

```{r}
t = c(0.2,1.4)
get_height(adm = my_adm,
           t = t,
           destructive = FALSE)
```
## Further information

For information on estimating age-depth models from sedimentation rates, see
```{r, eval=FALSE}
vignette("adm_from_sedrate")
```

For information on estimating age-depth models from tracer contents of rocks and sediments, see
```{r, eval=FALSE}
vignette("adm_from_trace_cont")
```
 

## References
* Burgess, Peter. "CarboCAT: A cellular automata model of heterogeneous carbonate strata." Computers & geosciences 53 (2013): 129-140. [DOI: 10.1016/j.cageo.2011.08.026](https://doi.org/10.1016/j.cageo.2011.08.026)
* Burgess, Peter. "CarboCAT Lite v1.0.1". Zenodo 2023. [DOI: 10.5281/zenodo.8402578](https://doi.org/10.5281/zenodo.8402578)
